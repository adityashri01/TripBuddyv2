<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - TripBuddy</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body>

    <header class="dashboard-header">
        <div class="header-container">
            <div class="logo">
                <img src="{{ url_for('static', filename='images/tripbuddy.png') }}" alt="TripBuddy Logo" class="logo-img">
            </div>
            <div class="header-right-section">
                <nav class="dashboard-nav-header">
                    <ul>
                        <li><a href="{{ url_for('find_rides') }}">Find Rides</a></li>
                        <li><a href="{{ url_for('post_ride') }}">Post Ride</a></li>
                        <li><a href="#">My Rides</a></li> </ul>
                </nav>
                <div class="header-actions">
                    <button class="notification-bell" aria-label="Notifications">
                        <i class="fas fa-bell"></i>
                    </button>
                    <a href="{{ url_for('logout') }}" class="logout-btn-header">Logout</a>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="dashboard-content">
            <h1 class="welcome-heading">Welcome, {{ name }}!</h1>
            
            <div class="user-summary-section">
                <div class="user-avatar-placeholder">
                    <i class="fas fa-user-circle"></i> </div>
                <div class="user-details">
                    <p class="logged-in-as"><i class="fas fa-info-circle info-icon"></i> You are logged in as a:</p>
                    <p class="user-role-display">
                        {% if role == 'Renter' %}
                            <i class="fas fa-user-tag role-icon"></i> Renter
                        {% elif role == 'Provider' %}
                            <i class="fas fa-car-side role-icon"></i> Provider
                        {% else %}
                            <i class="fas fa-user role-icon"></i> {{ role }} {% endif %}
                    </p>
                    <p class="user-email-display"><i class="fas fa-envelope email-icon"></i> {{ current_user.email }}</p>
                    
                    <p class="user-meta-info"><i class="fas fa-clock meta-icon"></i> Last Login: {{ current_user.last_login_date | default('N/A') }}</p>
                    <p class="user-meta-info">
                        {% if current_user.is_email_verified %}
                            <i class="fas fa-check-circle verified-icon"></i> Email Verified
                        {% else %}
                            <i class="fas fa-exclamation-triangle unverified-icon"></i> Email Not Verified (<a href="#" class="verify-link">Verify Now</a>)
                        {% endif %}
                    </p>

                    <a href="#" class="edit-profile-link"><i class="fas fa-edit"></i> Edit Profile</a>
                </div>
            </div>
        </div>

        {% if role and (role.lower() == 'renter' or role.lower() == 'provider') %}
        <div class="provider-cta-section">
            <div class="provider-cta-text">
                <h2>Want to Offer Rides?</h2>
                <p>Become a provider and start sharing your journey with others.</p>
            </div>
            <a href="#" class="become-provider-btn">Become a Provider</a>
        </div>
        {% endif %}

        <div class="dashboard-stats-grid">
            <div class="stat-card">
                <h3 class="stat-title">Rides Offered</h3>
                <i class="fas fa-car stat-icon"></i>
                <p class="stat-value">{{ rides_offered_count | default(0) }}</p> {# Updated to display dynamic count #}
                <p class="stat-description">Your active ride offers</p>
            </div>
            <div class="stat-card">
                <h3 class="stat-title">Rides Taken</h3>
                <i class="fas fa-road stat-icon"></i>
                <p class="stat-value">{{ rides_taken_count | default(0) }}</p> {# Display dynamic rides taken count #}
                <p class="stat-description">Seats booked by you</p>
            </div>
            <div class="stat-card">
                <h3 class="stat-title">Average Rating</h3>
                <i class="fas fa-star stat-icon"></i>
                <p class="stat-value">{{ average_rating | default('N/A') }}</p>
                <p class="stat-description">Dynamic data</p>
            </div>
            <div class="stat-card">
                <h3 class="stat-title">Wallet Balance</h3>
                <i class="fas fa-wallet stat-icon"></i>
                <p class="stat-value">{{ wallet_balance | default('0.00') }}</p>
                <p class="stat-description">Dynamic data</p>
            </div>
        </div>

        <section class="quick-actions-section">
            <h2 class="quick-actions-heading">Quick Actions</h2>
            <div class="action-grid">
                <a href="{{ url_for('find_rides') }}" class="action-card">
                    <i class="fas fa-search action-icon"></i>
                    <p class="action-text">Find a Ride</p>
                </a>
                <a href="{{ url_for('post_ride') }}" class="action-card">
                    <i class="fas fa-plus-circle action-icon"></i>
                    <p class="action-text">Offer a Ride</p>
                </a>
                <a href="#" class="action-card">
                    <i class="fas fa-history action-icon"></i>
                    <p class="action-text">Ride History</p>
                </a>
                <a href="#" class="action-card">
                    <i class="fas fa-comments action-icon"></i>
                    <p class="action-text">Messages</p>
                </a>
                <a href="#" class="action-card">
                    <i class="fas fa-cog action-icon"></i>
                    <p class="action-text">Settings</p>
                </a>
            </div>
        </section>
        <h2 class="main-activity-title">Your Activity</h2>
        <section class="activity-cards-grid">
            <div class="card discover-adventure-card">
                <h3>Discover Your Next Adventure</h3>
                <p>Search for available rides or connect with fellow travelers.</p>
                <form class="search-ride-form">
                    <input type="text" placeholder="From where?" class="form-input">
                    <input type="text" placeholder="To where?" class="form-input">
                    <button type="submit" class="btn btn-primary">Search Rides <i class="fas fa-arrow-right"></i></button>
                </form>
            </div>

            <div class="card active-offers-card">
                <h3>Your Active Ride Offers</h3>
                {% if user_rides %}
                    <ul class="offer-list">
                        {% for ride in user_rides %}
                            <li class="offer-item">
                                <span class="offer-route">{{ ride.start_location }} to {{ ride.end_location }}</span>
                                <span class="offer-details">Price: â‚¹{{ "%.2f"|format(ride.price) }} | Available Seats: {{ ride.seats }}</span> {# Changed from 'Seats' to 'Available Seats' and removed 'Booked' #}
                                <div class="offer-actions">
                                    <a href="#" class="btn btn-sm btn-info">Edit</a>
                                    <a href="#" class="btn btn-sm btn-danger">Cancel</a>
                                </div>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p class="no-offers-message"><i class="fas fa-info-circle"></i> You currently have no active ride offers.</p>
                    <a href="{{ url_for('post_ride') }}" class="btn btn-secondary-outline">Post a New Ride</a>
                {% endif %}
            </div>
            </section>
        </main>

    <footer class="main-footer section-padding">
        <div class="footer-container container">
            <div class="footer-links-group">
                <h4>Quick Links</h4>
                <a href="{{ url_for('home') }}">Home</a>
                <a href="{{ url_for('home') }}#how-it-works">How It Works</a>
                <a href="{{ url_for('about') }}">About Us</a>
                <a href="#">Privacy Policy</a>
                <a href="#">Terms of Service</a>
            </div>
            <div class="footer-contact-group">
                <h4>Contact Us</h4>
                <p><i class="fas fa-envelope"></i> Email: support@tripbuddy.com</p>
                <p><i class="fas fa-phone"></i> Phone: +91-98765XXXXX</p>
                <p><i class="fas fa-map-marker-alt"></i> Address: 123,Lona,Delhi, India</p>
            </div>
            <div class="footer-social-group">
                <h4>Follow Us</h4>
                <div class="social-icons">
                    <a href="https://www.facebook.com" target="_blank" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="https://www.instagram.com" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="https://www.twitter.com" target="_blank" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="https://www.linkedin.com" target="_blank" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            <div class="footer-newsletter-group">
                <h4>Subscribe to Our Newsletter</h4>
                <form class="newsletter-form">
                    <input type="email" placeholder="Your email" required />
                    <button type="submit">Subscribe</button>
                </form>
            </div>
        </div>
        <p class="footer-copy">&copy; 2025 TripBuddy. All rights reserved.</p>
    </footer>

    </body>
</html>